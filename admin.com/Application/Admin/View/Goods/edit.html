
<div class="tpl-portlet-components">
    <div class="portlet-title">
        <div class="caption font-green bold">
            <span class="am-icon-code"></span> <empty name="data.id" > 新增商品<else/>编辑商品 </empty>
        </div>
    </div>
    <div class="tpl-block ">
        <div class="am-g tpl-amazeui-form">
            <div class="am-u-sm-12 am-u-md-9">
                <form class="am-form am-form-horizontal" method="post" action="{:U()}" onsubmit="sendPostData()">
                    <div class="am-form-group">
                        <label for="user-name" class="am-u-sm-3 am-form-label">商品名称</label>
                        <div class="am-u-sm-9">
                            <input type="text" id="user-name" name="name" value="{$data.name}" placeholder="商品名称">
                            <small>输入商品名称</small>
                        </div>
                    </div>
                    <div class="am-form-group">
                        <label for="" class="am-u-sm-3 am-form-label">商品价格</label>
                        <div class="am-u-sm-9">
                            <input type="text" name="shop_price" maxlength="60" value="{$data.shop_price}">
                            <small>输入商品价格</small>
                        </div>
                    </div>
                    <div class="am-form-group">
                        <label for="" class="am-u-sm-3 am-form-label">商品库存</label>
                        <div class="am-u-sm-9">
                            <input pattern="[0-9]*" name="stock"  value="{$data.stock}" type="number">
                            <small>输入商品库存</small>
                        </div>
                    </div>
                    <div class="am-form-group">
                        <label for="user-weibo" class="am-u-sm-3 am-form-label">商品图片</label>
                        <div class="am-u-sm-9">
                            <div class="am-form-group am-form-file">
                                <div class="tpl-form-file-img" id="upload_img">
                                    <empty name="data.logo">
                                        <img   src="__IMG__/a5.png" alt="">
                                    <else/>
                                        <img   src="{$data.logo}" alt="">
                                    </empty>
                                </div>
                                <button type="button" class="am-btn am-btn-danger am-btn-sm">
                                    <i class="am-icon-cloud-upload"></i> 添加商品图片</button>
                                <input id="doc-form-file" multiple="" type="file">
                            </div>
                            <input type="hidden" id="logo" name="logo" value="{$data.logo}">
                        </div>
                    </div>
                    <div class="am-form-group">
                        <label for="user-weibo" class="am-u-sm-3 am-form-label">商品视频</label>
                        <div class="am-u-sm-9">
                            <div class="am-form-group am-form-file">
                                <div class="tpl-form-file-img" id="upload_img2">
                                    <empty name="data.video_url">
                                        <img   src="__IMG__/a5.png" alt="">
                                    <else/>
                                        <img   src="__IMG__/timg.jpg" alt="">
                                    </empty>
                                </div>
                                <button type="button" class="am-btn am-btn-danger am-btn-sm">
                                    <i class="am-icon-cloud-upload"></i> 上传视频</button>
                                <input id="doc-form-file2" multiple="" type="file">
                            </div>
                            <input type="hidden" id="video_url" name="video_url" value="{$data.video_url}">
                        </div>
                    </div>

                    <div class="am-form-group">
                        <label for="" class="am-u-sm-3 am-form-label">商品状态</label>
                        <div class="am-u-sm-9">
                            <input type="radio" name="status" class="status" value="1" <eq name="data.status" value="1">checked</eq>  />正常
                            <input type="radio" name="status" class="status" value="0" <eq name="data.status" value="0">checked</eq>> 停用
                        </div>
                    </div>
                    <div class="am-form-group">
                        <label for="user-intro" class="am-u-sm-3 am-form-label">商品简介</label>
                        <div class="am-u-sm-9">
                            <textarea name="keyword" rows="3"  id="keyword" placeholder="输入简介">{$data.keyword}</textarea>
                        </div>
                    </div>
                    <div class="am-form-group">
                        <label for="user-intro" class="am-u-sm-3 am-form-label">商品详情</label>
                        <div class="am-u-sm-9">
                            <textarea type="text" id="detail" style="width:600px;height:400px;">{$data.detail}</textarea>
                        </div>
                    </div>
                    <div style="text-align: center">
                        <input type="hidden" name="id" value="{$data.id}"/>
                        <input type="submit" class="button"  value="保存"/>
                    </div>
                </form>
            </div>
        </div>
    </div>

</div>
<link rel="stylesheet" href="/Public/Admin/sweetalert/sweetalert2.css">
<script type="text/javascript" src="/Public/Admin/sweetalert/sweetalert2.js"></script>
<script type="text/javascript" charset="utf-8" src="__UEDITOR__/ueditor.config.js"></script>
<script type="text/javascript" charset="utf-8" src="__UEDITOR__/ueditor.all.min.js"> </script>
<!--建议手动加在语言，避免在ie下有时因为加载语言失败导致编辑器加载失败-->
<!--这里加载的语言文件会覆盖你在配置项目里添加的语言类型，比如你在配置项目里配置的是英文，这里加载的中文，那最后就是中文-->
<script type="text/javascript" charset="utf-8" src="__UEDITOR__/lang/zh-cn/zh-cn.js"></script>
<script type="text/javascript">

    UE.getEditor('detail',{
        autoHeight: false,
        toolbars: [
            ['fullscreen', 'source', 'undo', 'redo' ,'simpleupload', 'insertimage','insertvideo','iframe','preview'],
            ['bold', 'italic', 'underline', 'source','fontborder', 'strikethrough', 'superscript', 'subscript', 'removeformat', 'formatmatch', 'autotypeset', 'blockquote', 'pasteplain', '|', 'forecolor', 'backcolor', 'insertorderedlist', 'insertunorderedlist', 'selectall', 'cleardoc']
        ],
        autoClearinitialContent:false, //编辑器获取焦点时时自动清空初始化时的内容
        wordCount:true,                 //字数统计
        maximumWords:14000,
        wordCountMsg : '已输入 {#count} 个字符，您还可以输入{#leave} 个',
        wordOverFlowMsg : '<span style="color:red;">你输入的字符个数已经超出最大允许值，服务器可能会拒绝保存！</span>',
        initialFrameHeight:500          //高度
    });

    var editor = UE.getEditor('detail');
   /* function sendPostData(){
        swal({
            title: '',
            text: "确定保存?",
            type: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: '确定',
            cancelButtonText: '取消'
        }).then(function () {
            var is_valide =true;
            if (!UE.getEditor('detail').hasContents()){
                is_valide=false;
                swal("", '商品详情不能为空', "error");
            }else{
                /!*var content2 =UE.getEditor('detail').getContent();
                $('#info').val(content2);*!/
            }
        })
    }*/

</script>
    <script type="text/javascript" src="__UPLOADIFY__/jquery.uploadify.js"></script>
    <script type="text/javascript">
          //=======================文件上传   开始===================//
                //由于是一个flash显示的插件，加载需要插件，如果出现浏览器崩溃情况，可以用一个定时器让页面加载完之后一点时间在显示。
          $(document).ready(function(){
              //响应文件添加成功事件
              $("#doc-form-file").change(function(){
                  //创建FormData对象
                  var data = new FormData();
                  //为FormData对象添加数据
                 $.each($('#doc-form-file')[0].files, function(i, file) {
                      data.append('upload_file'+i, file);
                  });
                  //发送数据
                  $.ajax({
                      url:'{:U("Uploader/index")}', /*去过那个php文件*/
                      type:'POST',  /*提交方式*/
                      data:data,
                      cache: false,
                      contentType: false,        /*不可缺*/
                      processData: false,         /*不可缺*/
                      success:function(data){
                          if(data.code){
                              $("#upload_img img").attr('src',data.url);
                              $("#logo").val(data.url);
                          }
                      },
                      error:function(){
                          alert('上传出错');
                      }
                  });
              });

              $("#doc-form-file2").change(function(){
                  //创建FormData对象
                  var data = new FormData();
                  //为FormData对象添加数据
                  $.each($('#doc-form-file2')[0].files, function(i, file) {
                      data.append('upload_file'+i, file);
                  });
                  //发送数据
                  $.ajax({
                      url:'{:U("Uploader/index")}', /*去过那个php文件*/
                      type:'POST',  /*提交方式*/
                      data:data,
                      cache: false,
                      contentType: false,        /*不可缺*/
                      processData: false,         /*不可缺*/
                      success:function(data){
                          if(data.code){
                              var  url = "__IMG__/timg.jpg";
                              $("#upload_img2 img").attr('src',url);
                              $("#video_url").val(data.url);
                          }
                      },
                      error:function(){
                          alert('上传出错');
                      }
                  });
              });



          });

    </script>
